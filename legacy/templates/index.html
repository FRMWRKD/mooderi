{% extends "base.html" %}

{% block content %}
<div class="gallery-header">
    <h1>Public Library</h1>
    <div class="gallery-controls">
        <div class="sort-dropdown">
            <label>Sort by:</label>
            <select id="sort-select" onchange="window.location.href='/?sort=' + this.value">
                <option value="ranked" {% if current_sort=='ranked' %}selected{% endif %}>üèÜ Top Rated</option>
                <option value="newest" {% if current_sort=='newest' %}selected{% endif %}>Newest</option>
                <option value="rating" {% if current_sort=='rating' %}selected{% endif %}>Highest AI Score</option>
                <option value="popular" {% if current_sort=='popular' %}selected{% endif %}>Most Liked</option>
                <option value="controversial" {% if current_sort=='controversial' %}selected{% endif %}>Most Disliked
                </option>
            </select>
        </div>
        <div class="view-options">
            <button id="btn-filter-toggle" class="btn-icon-soft" onclick="toggleFilterMenu()" title="Filter options">
                <i class="bi bi-sliders2"></i>
            </button>
            <div class="divider-vertical"></div>
            <button class="active"><i class="bi bi-grid-fill"></i></button>
            <button><i class="bi bi-list-ul"></i></button>
        </div>
    </div>
</div>

<!-- Cleaner Filter Interface -->
<div class="filter-popover hidden" id="filter-popover">
    <div class="filter-section">
        <h3>Mood</h3>
        <div class="filter-chips">
            <a href="/search?q=cinematic" class="filter-chip">Cinematic</a>
            <a href="/search?q=moody" class="filter-chip">Moody</a>
            <a href="/search?q=vibrant" class="filter-chip">Vibrant</a>
            <a href="/search?q=minimal" class="filter-chip">Minimal</a>
            <a href="/search?q=dark" class="filter-chip">Dark</a>
            <a href="/search?q=neon" class="filter-chip">Neon</a>
        </div>
    </div>

    <div class="filter-section">
        <h3>Colors</h3>
        <div class="color-options">
            <a href="/search?color=%23ff0000" class="color-select" style="background: #ff0000;" title="Red"></a>
            <a href="/search?color=%2300ff00" class="color-select" style="background: #00ff00;" title="Green"></a>
            <a href="/search?color=%230000ff" class="color-select" style="background: #0000ff;" title="Blue"></a>
            <a href="/search?color=%23ffff00" class="color-select" style="background: #ffff00;" title="Yellow"></a>
            <a href="/search?color=%23ff00ff" class="color-select" style="background: #ff00ff;" title="Magenta"></a>
            <a href="/search?color=%2300ffff" class="color-select" style="background: #00ffff;" title="Cyan"></a>
            <a href="/search?color=%23ffffff" class="color-select" style="background: #ffffff;" title="White"></a>
            <a href="/search?color=%23000000" class="color-select" style="background: #000000; border: 1px solid #333;"
                title="Black"></a>
        </div>
    </div>

    <div class="filter-section">
        <h3>AI Quality</h3>
        <div class="option-row">
            <label>Min Score: <span id="score-val">3</span></label>
            <input type="range" min="1" max="10" value="3"
                oninput="document.getElementById('score-val').innerText = this.value">
        </div>
    </div>

    <div class="filter-actions">
        <button class="btn-secondary btn-sm" onclick="toggleFilterMenu()">Reset</button>
        <button class="btn-primary btn-sm" onclick="toggleFilterMenu()">Apply</button>
    </div>
</div>

{% from 'components/card_video.html' import video_card %}

<!-- Result Count -->
<div id="result-count" class="result-count" style="margin-bottom: 16px; color: var(--text-secondary); font-size: 14px;">
    Showing {{ images|length }} images
</div>

<!-- No Results State -->
{% if images|length == 0 %}
<div class="empty-state" style="text-align: center; padding: 80px 20px;">
    <i class="bi bi-search"
        style="font-size: 48px; color: var(--text-tertiary); margin-bottom: 16px; display: block;"></i>
    <h2 style="margin-bottom: 8px;">No images found</h2>
    <p class="text-secondary">Try adjusting your filters or search query.</p>
</div>
{% else %}
<div class="masonry-grid image-focused">
    {% for image in images %}
    {{ video_card(image) }}
    {% endfor %}
</div>
{% endif %}

{% endblock %}